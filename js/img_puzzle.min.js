function get_img_puzzle(e){function t(e){let t=e.moves,o=e.time_formatted.minutes,n=e.time_formatted.seconds,i=e.played_difficulty;alert("You win! You did it in "+t+" moves and "+o+" minute(s) and "+n+" seconds. The difficulty was "+i)}function o(){console.error("get_img_puzzle : Image could not be loaded")}function n(e,t){return Math.random()*(t-e)+e}function i(e){if(!1!==q)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(o){o.preventDefault(),!1!==q&&(z=this.offsetLeft,E=this.offsetTop,S=o.pageX,A=o.pageY,this.addEventListener("mousemove",l),this.addEventListener("mouseleave",l),M.addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",l),e[t].removeEventListener("mouseleave",l)}))}),e[t].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===q)return;z=this.offsetLeft,E=this.offsetTop;let n=o.touches;S=n[0].pageX,A=n[0].pageY,this.addEventListener("touchmove",s),M.addEventListener("touchend",function(o){o.preventDefault(),e[t].removeEventListener("touchmove",s)})})}function l(e){this.style.left=z+e.pageX-S+"px",this.style.top=E+e.pageY-A+"px"}function s(e){var t=e.touches;this.style.left=z+t[0].pageX-S+"px",this.style.top=E+t[0].pageY-A+"px"}try{if("object"!=typeof e)throw"An object must be passed to the function! Now it is: "+typeof e}catch(e){return void console.error("get_img_puzzle : "+e)}let f=e.image,r=e.holder_div,u=e.after_win,a=e.difficulty||"normal",p=e.shuffle_delay||3e3,c=e.shuffle_integer||50,d=e.elem_shadow,h=e.on_shuffle||!1,g=e.until_shuffle||!1,m=e.is_shuffle_animation||!1,y=e.get_img;try{if("string"!=typeof f&&!Array.isArray(f))throw"images expecting to be a string or an array, "+typeof f+" given";if("string"!=typeof r)throw"div_holder expecting to be a string, "+typeof r+" given";if(!document.querySelector(r))throw"div_holder ( "+r+" ) cannot be found.";if("function"!=typeof u&&void 0!==u)throw"after_win expecting to be a function, "+typeof u+" given";if("number"!=typeof p)throw"shuffle_delay expecting to be a number, "+typeof p+" given";if("number"!=typeof c)throw"shuffle_integer expecting to be a number, "+typeof c+" given";if("boolean"!=typeof d&&void 0!==d)throw"elem_shadow expecting to be a boolean, "+typeof d+" given";if("string"!=typeof a)throw"difficulty expecting to be a string, "+typeof a+" given";if("easy"!==a&&"normal"!==a&&"hard"!==a&&"nightmare"!==a)throw"difficulty can be easy, normal, hard or nightmare";if("function"!==h&&"boolean"===h)throw"on_shuffle expecting to be a function, "+typeof h+" given";if("function"!==g&&"boolean"===g)throw"until_shuffle expecting to be a function, "+typeof g+" given";if("boolean"!=typeof m)throw"is_shuffle_animation expecting to be a boolean, "+typeof m+" given";if("function"!=typeof y&&void 0!==y)throw"get_img expecting to be a function, "+typeof y+" given";if(0==document.querySelector(r).offsetHeight||0==document.querySelector(r).offsetWidth)throw"The main holder's ( "+r+" ) width or height has been set to 0. It cannot be seen."}catch(e){return void console.error("get_img_puzzle : "+e)}void 0===u&&(u=t),void 0===d&&(d=!0);let v,x,_=0,b=0,w="",L="",T=new Image,q=!1;T.onerror=o;let z,E,S,A,M="";if(T.onload=function(){function e(e,t){X=Math.round(k*C/e)*e,H=Math.round(I*C/t)*t,V=e*t-1,w=H/t,L=X/e}function t(e){if(!1===q)return;let t=document.querySelectorAll(r+" ._game_output ."+e.target.classList);if("mousedown"===e.type||"touchstart"===e.type){for(let e=0;e<t.length;e++)t[e].style.transition="all 0s";J.push(e.target.offsetTop),J.push(e.target.offsetLeft),e.target.style.zIndex="2",0===_&&(v=new Date)}if("touchend"===e.type||"mouseup"===e.type){for(let e=0;e<t.length;e++)t[e].style.transition="all 0.3s";let n,i,l=M.getBoundingClientRect(),s=l.left,f=l.top,r=[];"mouseup"===e.type&&(n=e.clientX,i=e.clientY,r.push(n-s,i-f)),"touchend"===e.type&&(n=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,r.push(n-s,i-f));for(let n=0;n<t.length;n++)if(t[n]!==e.target||n===t.length-1){if(r[0]>t[n].offsetLeft&&r[0]<t[n].offsetLeft+L&&r[1]>t[n].offsetTop&&r[1]<t[n].offsetTop+w){o(e.target,t[n]),_++;break}n==t.length-1&&(e.target.style.top=J[0]+"px",e.target.style.left=J[1]+"px",J=[],b++)}e.target.style.zIndex="1",E()}}function o(e,t){let o=e.getAttribute("data-sequence"),n=t.getAttribute("data-sequence");e.setAttribute("data-sequence",n),t.setAttribute("data-sequence",o),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=J[0]+"px",t.style.left=J[1]+"px",J=[],!0===q&&setTimeout(function(){l()},350)}function l(){for(let e=0;e<N.length;e++){let t=N[e].getAttribute("data-sequence");A+=t,e===N.length-1&&(A===S?(q=!1,s()):A="")}}function s(){x=new Date;let e=x-v,t=e/1e3%60,o={minutes:Math.round(e/1e3/60),seconds:Math.floor(t)},n={moves:_,cancelled_moves:b,time_ms:e,time_s:Math.floor(e/1e3),time_m:e/1e3/60,time_formatted:o,total_shuffle:c,played_difficulty:a};if(u(n,N),!0===d)for(let e=0;e<N.length;e++)N[e].style.boxShadow="inset 0px 0px 0px #ccc"}function f(){h&&h(),g&&g();let e=document.querySelectorAll(r+" ._game_output .bg-elem");for(let t=0;t<c;t++){let n=Math.floor(Math.random()*e.length),l=Math.floor(Math.random()*e.length);if(J.push(e[n].offsetTop),J.push(e[n].offsetLeft),o(e[n],e[l]),t==c-1)if(!0===m)z();else{if(q=!0,!0===d)for(let e=0;e<N.length;e++)N[e].style.boxShadow="inset 1px 1px 3px #ccc";i(N)}}}function z(){let e=[],t=[];for(let o=0;o<N.length;o++)e.push(N[o].offsetTop),t.push(N[o].offsetLeft);let o=H/2-w/2,n=X/2-L/2;for(let e=0;e<N.length;e++)N[e].style.top=o+"px",N[e].style.left=n+"px";G.style.top=o+"px",G.style.left=n+"px",G.style.width=L+"px",G.style.height=w+"px",G.style.backgroundPosition="-"+n+"px -"+o+"px",setTimeout(function(){for(let e=0;e<N.length;e++)N[e].style.transition="all 0.3s";for(let o=0;o<N.length;o++)setTimeout(function(){N[o].style.top=e[o]+"px",N[o].style.left=t[o]+"px"},100*o),o===N.length-1&&setTimeout(function(){if(q=!0,!0===d)for(let e=0;e<N.length;e++)N[e].style.boxShadow="inset 1px 1px 3px #ccc";i(N),g&&g(!0)},1+100*o);G.remove()},400)}function E(){!1!==q&&(q=!1,setTimeout(function(){q=!0},310))}y&&y(T.src);let S="",A="",k=T.width,I=T.height,Y=document.querySelector(r).offsetHeight,D=document.querySelector(r).offsetWidth,C=Math.min(D/k,Y/I),X=0,H=0,j=0,P=0,V=0;if("easy"===a&&(j=5,P=2),"normal"===a&&(j=7,P=2),"hard"===a&&(j=7,P=3),"nightmare"===a&&(j=8,P=4),e(j,P),document.querySelectorAll(r+" ._game_output .bg-elem")){let e=document.querySelectorAll(r+" ._game_output .bg-elem");for(let o=0;o<e.length;o++)e[o].removeEventListener("touchstart",t),e[o].removeEventListener("mousedown",t),e[o].removeEventListener("touchend",t),e[o].removeEventListener("mouseup",t)}let W=document.querySelector(r);for(;W.firstChild;)W.removeChild(W.firstChild);get_img_puzzle.holder===r&&clearTimeout(get_img_puzzle.wait),get_img_puzzle.holder=r;let B=document.createElement("DIV");B.classList.add("_game_output"),document.querySelector(r).appendChild(B),M=document.querySelector("._game_output"),M.style.overflow="hidden";for(let e=0;e<=V;e++){let e=Math.floor(n(0,V-1));M.innerHTML+="<div data-sequence="+e+" class='bg-elem'></div>\n"}M.style.position="absolute",M.style.width=X+"px",M.style.height=H+"px",M.style.left="50%",M.style.marginLeft=-X/2+"px";let N=document.querySelectorAll(r+" ._game_output .bg-elem"),R=0,F=0;for(let e=0;e<N.length;e++){let t=N[e].getAttribute("data-sequence");S+=t,N[e].style.position="absolute",N[e].style.backgroundImage="url('"+T.src+"')",N[e].style.backgroundSize=X+"px "+H+"px",N[e].style.height=w+"px",N[e].style.width=L+"px",N[e].style.left=L*F+"px",0===R?(N[e].style.top="0px",F++):(N[e].style.top=w*R+"px",F++),F===j&&(F=0,R++);let o=N[e].offsetLeft,n=N[e].offsetTop;N[e].style.backgroundPosition=-o+"px "+-n+"px"}let G="";if(!0===m){let e=document.createElement("DIV");e.classList.add("overlay_div"),M.appendChild(e),G=document.querySelector(".overlay_div"),G.setAttribute("style","position: relative;width: 100%;height: 100%;left: 0px;top: 0px;background-image: url('"+T.src+"');background-size: "+X+"px "+H+"px;background-position: -"+G.offsetLeft+"px -"+G.offsetTop+"px;z-index: 3;transition: all .3s linear;")}let J=[];for(let e=0;e<N.length;e++)N[e].addEventListener("touchstart",t),N[e].addEventListener("mousedown",t),N[e].addEventListener("touchend",t),N[e].addEventListener("mouseup",t);get_img_puzzle.wait=setTimeout(f,p)},Array.isArray(f)){let e=Math.floor(n(0,f.length-1));T.src=f[e]}"string"==typeof f&&(T.src=f)}