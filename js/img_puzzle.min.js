function get_img_puzzle(e){function t(){console.error("get_img_puzzle : Image could not be loaded")}function o(e,t){return Math.random()*(t-e)+e}function n(e){if(!1!==q)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(o){o.preventDefault(),!1!==q&&(m=this.offsetLeft,v=this.offsetTop,x=o.pageX,b=o.pageY,this.addEventListener("mousemove",l),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",l)}),document.querySelector(s).addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",l)}))}),e[t].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===q)return;m=this.offsetLeft,v=this.offsetTop;let n=o.touches;x=n[0].pageX,b=n[0].pageY,this.addEventListener("touchmove",i),document.querySelector(s).addEventListener("touchend",function(o){o.preventDefault(),e[t].removeEventListener("touchmove",i)})})}function l(e){this.style.left=m+e.pageX-x+"px",this.style.top=v+e.pageY-b+"px"}function i(e){var t=e.touches;this.style.left=m+t[0].pageX-x+"px",this.style.top=v+t[0].pageY-b+"px"}try{if("object"!=typeof e)throw"An object must be passed to the function! Now it is: "+typeof e}catch(e){return void console.error("get_img_puzzle : "+e)}let r=e.image,s=e.holder_div,f=e.after_win,u=e.difficulty||"regular",a=e.shuffle_delay||3e3,p=e.shuffle_integer||50,d=e.elem_shadow,c=e.on_shuffle||!1,h=e.until_shuffle;try{if("string"!=typeof r&&!Array.isArray(r))throw"images expecting to be a string or an array, "+typeof r+" given";if("string"!=typeof s)throw"div_holder expecting to be a string, "+typeof s+" given";if("function"!=typeof f)throw"after_win expecting to be a function, "+typeof f+" given";if("number"!=typeof a)throw"shuffle_delay expecting to be a number, "+typeof a+" given";if("number"!=typeof p)throw"shuffle_integer expecting to be a number, "+typeof p+" given";if("boolean"!=typeof d&&void 0!==d)throw"elem_shadow expecting to be a boolean, "+typeof d+" given";if("string"!=typeof u)throw"difficulty expecting to be a string, "+typeof u+" given";if("regular"!==u&&"hard"!==u)throw"difficulty can be regular or hard";if("function"!==c&&"boolean"===c)throw"on_shuffle expecting to be a function, "+typeof c+" given";if("function"!==h&&"boolean"===h)throw"until_shuffle expecting to be a function, "+typeof h+" given"}catch(e){return void console.error("get_img_puzzle : "+e)}void 0===d&&(d=!0);let g,y,m,v,x,b,w=0,_=0,L="",z="",E=new Image,q=!1;if(document.querySelector(s).style.position="relative",document.querySelector(s).style.overflow="hidden",E.onerror=t,E.onload=function(){function e(o){if(!1===q)return;let n=document.querySelectorAll(s+" ."+o.target.classList);if("mousedown"===o.type||"touchstart"===o.type){o.target.addEventListener("mouseleave",e);for(let e=0;e<n.length;e++)n[e].style.transition="all 0s";j.push(o.target.offsetTop),j.push(o.target.offsetLeft),o.target.style.zIndex="999",0===w&&(g=new Date)}if("touchend"===o.type||"mouseup"===o.type){for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let e,l,i=document.querySelector(s).getBoundingClientRect(),r=window.innerWidth-i.right,f=window.innerHeight-i.bottom,u=[];"mouseup"===o.type&&(e=o.clientX,l=o.clientY,u.push(e-r,l)),"touchend"===o.type&&(f=i.top,r=i.left,e=o.changedTouches[0].clientX,l=o.changedTouches[0].clientY,u.push(e-r,l-f));let a=o.target.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=a){if(u[0]>n[e].offsetLeft&&u[0]<n[e].offsetLeft+n[e].offsetWidth&&u[1]>n[e].offsetTop&&u[1]<n[e].offsetTop+n[e].offsetHeight){t(o.target,n[e]),w++;break}e==n.length-1&&(o.target.style.top=j[0]+"px",o.target.style.left=j[1]+"px",j=[],_++)}o.target.style.zIndex="1",m()}return"mouseleave"===o.type?(o.target.removeEventListener("mouseleave",e),o.target.style.top=j[0]+"px",o.target.style.left=j[1]+"px",void(j=[])):void 0}function t(e,t){let n=e.getAttribute("data-sequence"),l=t.getAttribute("data-sequence");e.setAttribute("data-sequence",l),t.setAttribute("data-sequence",n),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=j[0]+"px",t.style.left=j[1]+"px",j=[],!0===q&&setTimeout(function(){o()},350)}function o(){for(let e=0;e<Y.length;e++){let t=Y[e].getAttribute("data-sequence");x+=t,e==Y.length-1&&(x==v?(q=!1,l()):x="")}}function l(){y=new Date;let e=y-g,t=e/1e3%60,o={minutes:Math.round(e/1e3/60),seconds:Math.floor(t)},n={moves:w,cancelled_moves:_,time_ms:e,time_s:Math.floor(e/1e3),time_m:e/1e3/60,time_formatted:o,total_shuffle:p,played_difficulty:u};if(f(n,Y),!0===d)for(let e=0;e<Y.length;e++)Y[e].style.boxShadow="inset 0px 0px 0px #ccc"}function i(){c&&c(),h&&h();let e=document.querySelectorAll(s+" .bg-elem");for(let o=0;o<p;o++){let n=Math.floor(Math.random()*e.length),l=Math.floor(Math.random()*e.length);j.push(e[n].offsetTop),j.push(e[n].offsetLeft),t(e[n],e[l]),o==p-1&&r()}}function r(){let e=[],t=[];for(let o=0;o<Y.length;o++)e.push(Y[o].offsetTop),t.push(Y[o].offsetLeft);let o=D/2-L/2,l=k/2-z/2;for(let e=0;e<Y.length;e++)Y[e].style.top=o+"px",Y[e].style.left=l+"px";W.style.top=o+"px",W.style.left=l+"px",W.style.width=z+"px",W.style.height=L+"px",W.style.backgroundPosition="-"+l+"px -"+o+"px",setTimeout(function(){for(let e=0;e<Y.length;e++)Y[e].style.transition="all 0.3s";for(let o=0;o<Y.length;o++)setTimeout(function(){Y[o].style.top=e[o]+"px",Y[o].style.left=t[o]+"px"},100*o),o===Y.length-1&&setTimeout(function(){if(q=!0,!0===d)for(let e=0;e<Y.length;e++)Y[e].style.boxShadow="inset 1px 1px 3px #ccc";n(Y),h&&h(!0)},1+100*o);W.remove()},400)}function m(){!1!==q&&(q=!1,setTimeout(function(){q=!0},310))}let v="",x="",b=E.width,T=E.height,A=window.innerHeight,S=window.innerWidth,M=Math.min(S/b,A/T),k=0,D=0;if("regular"===u&&(k=7*Math.round(b*M/7),D=2*Math.round(T*M/2)),"hard"===u&&(k=7*Math.round(b*M/7),D=3*Math.round(T*M/3)),document.querySelectorAll(".bg-elem")){let t=document.querySelectorAll(".bg-elem");for(let o=0;o<t.length;o++)t[o].removeEventListener("touchstart",e),t[o].removeEventListener("mousedown",e),t[o].removeEventListener("touchend",e),t[o].removeEventListener("mouseup",e)}let I=document.querySelector(s);for(;I.firstChild;)I.removeChild(I.firstChild);get_img_puzzle.holder===s&&clearTimeout(get_img_puzzle.wait),get_img_puzzle.holder=s;let X=0;"regular"===u&&(X=13),"hard"===u&&(X=20);for(let e=0;e<=X;e++)I.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";I.style.width=k+"px",I.style.height=D+"px",I.style.left="50%",I.style.marginLeft=-k/2+"px";let Y=document.querySelectorAll(s+" .bg-elem");for(let e=0;e<Y.length;e++){let t=Y[e].getAttribute("data-sequence");v+=t}for(let e=0;e<Y.length;e++)Y[e].style.position="absolute",Y[e].style.backgroundImage="url('"+E.src+"')",Y[e].style.backgroundSize=k+"px "+D+"px",z=k/7,Y[e].style.width=z+"px","regular"===u&&(L=D/2),"hard"===u&&(L=D/3),Y[e].style.height=L+"px";let C=0;for(let e=0;e<Y.length;e++){Y[e].style.left=z*C+"px","regular"===u&&(e<=6&&(Y[e].style.top="0px"),e>6&&(Y[e].style.top=L+"px")),"hard"===u&&(e<=6&&(Y[e].style.top="0px"),e>6&&e<14&&(Y[e].style.top=L+"px"),e>=14&&(Y[e].style.top=L+L+"px"));let t=Y[e].offsetLeft,o=Y[e].offsetTop;Y[e].style.backgroundPosition=-t+"px "+-o+"px",C++,7==C&&(C=0)}let H=document.createElement("DIV");H.classList.add("overlay_div"),document.querySelector(s).appendChild(H);let W=document.querySelector(".overlay_div");W.setAttribute("style","position: relative;width: 100%;height: 100%;left: 0px;top: 0px;background-image: url('"+E.src+"');background-size: "+k+"px "+D+"px;background-position: -"+W.offsetLeft+"px -"+W.offsetTop+"px;z-index: 999;transition: all .3s linear;");let j=[];for(let t=0;t<Y.length;t++)Y[t].addEventListener("touchstart",e),Y[t].addEventListener("mousedown",e),Y[t].addEventListener("touchend",e),Y[t].addEventListener("mouseup",e);get_img_puzzle.wait=setTimeout(i,a)},Array.isArray(r)){let e=Math.floor(o(0,r.length-1));E.src=r[e]}"string"==typeof r&&(E.src=r)}