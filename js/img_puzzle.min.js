function get_img_puzzle(e,t,n="regular",o=3e3,l=50){function i(e,t){return Math.random()*(t-e)+e}function s(e){if(!1!==p)for(let n=0;n<e.length;n++)e[n].addEventListener("mousedown",function(o){o.preventDefault(),!1!==p&&(u=this.offsetLeft,a=this.offsetTop,d=o.pageX,c=o.pageY,this.addEventListener("mousemove",r),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",r)}),document.querySelector(t).addEventListener("mouseup",function(){e[n].removeEventListener("mousemove",r)}))}),e[n].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===p)return;u=this.offsetLeft,a=this.offsetTop;let l=o.touches;d=l[0].pageX,c=l[0].pageY,this.addEventListener("touchmove",f),document.querySelector(t).addEventListener("touchend",function(t){t.preventDefault(),e[n].removeEventListener("touchmove",f)})})}function r(e){this.style.left=u+e.pageX-d+"px",this.style.top=a+e.pageY-c+"px"}function f(e){var t=e.touches;this.style.left=u+t[0].pageX-d+"px",this.style.top=a+t[0].pageY-c+"px"}let u,a,d,c,h=new Image,p=!1;if(h.onload=function(){function e(e,t){if(!1!==p){t.addEventListener("mouseleave",i);for(let t=0;t<e.length;t++)e[t].style.transition="all 0s";S.push(t.offsetTop),S.push(t.offsetLeft),t.style.zIndex="999"}}function i(e,n,o,l){if(!1===p)return;if("mouseleave"===e.type)return event.target.removeEventListener("mouseleave",i),event.target.style.top=S[0]+"px",event.target.style.left=S[1]+"px",void(S=[]);for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let s,f,u=window.innerWidth-document.querySelector(t).getBoundingClientRect().right,a=window.innerHeight-document.querySelector(t).getBoundingClientRect().bottom,d=[];!1===l&&(s=e.clientX,f=e.clientY,d.push(s-u,f+a)),!0===l&&(a=document.querySelector(t).getBoundingClientRect().top,u=document.querySelector(t).getBoundingClientRect().left,s=e.changedTouches[0].clientX,f=e.changedTouches[0].clientY,d.push(s-u,f-a));let c=o.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=c){if(d[0]>n[e].offsetLeft&&d[0]<n[e].offsetLeft+n[e].offsetWidth&&d[1]>n[e].offsetTop&&d[1]<n[e].offsetTop+n[e].offsetHeight){r(o,n[e]);break}e==n.length-1&&(o.style.top=S[0]+"px",o.style.left=S[1]+"px",S=[])}o.style.zIndex="1"}function r(e,t){let n=e.getAttribute("data-sequence"),o=t.getAttribute("data-sequence");e.setAttribute("data-sequence",o),t.setAttribute("data-sequence",n),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=S[0]+"px",t.style.left=S[1]+"px",S=[],!0===p&&setTimeout(function(){f()},350)}function f(){for(let e=0;e<T.length;e++){let t=T[e].getAttribute("data-sequence");g+=t,e==T.length-1&&(g==c?(p=!1,u()):g="")}}function u(){alert("you win");for(let e=0;e<T.length;e++)T[e].style.boxShadow="inset 0px 0px 0px #ccc"}function a(){let e=document.querySelectorAll(".bg-elem");for(let t=0;t<=l;t++){let n=Math.floor(Math.random()*e.length),o=Math.floor(Math.random()*e.length);if(S.push(e[n].offsetTop),S.push(e[n].offsetLeft),r(e[n],e[o]),t==l){p=!0;for(let e=0;e<T.length;e++)T[e].style.boxShadow="inset 1px 1px 3px #ccc";s(T)}}}function d(){!1!==p&&(p=!1,setTimeout(function(){p=!0},310))}let c="",g="",y=h.width,m=h.height,x=window.innerHeight,v=window.innerWidth,L=Math.min(v/y,x/m),b=0,w=0;"regular"===n&&(b=7*Math.round(y*L/7),w=2*Math.round(m*L/2)),"hard"===n&&(b=7*Math.round(y*L/7),w=3*Math.round(m*L/3));let q=document.querySelector(t);for(;q.firstChild;)q.removeChild(q.firstChild);let E=0;"regular"===n&&(E=13),"hard"===n&&(E=20);for(let e=0;e<=E;e++)q.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";q.style.width=b+"px",q.style.height=w+"px",q.style.left="50%",q.style.marginLeft=-b/2+"px";let T=document.querySelectorAll(".bg-elem");for(let e=0;e<T.length;e++){let t=T[e].getAttribute("data-sequence");c+=t}for(let e=0;e<T.length;e++)T[e].style.backgroundImage="url('"+h.src+"')",T[e].style.backgroundSize=b+"px "+w+"px",T[e].style.width=b/7+"px","regular"===n&&(T[e].style.height=w/2+"px"),"hard"===n&&(T[e].style.height=w/3+"px");let M=0;for(let e=0;e<T.length;e++){if("regular"===n){T[e].style.left=b/7*M+"px",e<=6&&(T[e].style.top="0px"),e>6&&(T[e].style.top=w/2+"px");let t=T[e].offsetLeft,n=T[e].offsetTop;T[e].style.backgroundPosition=-t+"px "+-n+"px"}if("hard"===n){T[e].style.left=b/7*M+"px",e<=6&&(T[e].style.top="0px"),e>6&&e<14&&(T[e].style.top=w/3+"px"),e>=14&&(T[e].style.top=w/3+w/3+"px");let t=T[e].offsetLeft,n=T[e].offsetTop;T[e].style.backgroundPosition=-t+"px "+-n+"px"}M++,7==M&&(M=0)}let S=[];for(let t=0;t<T.length;t++)T[t].addEventListener("touchstart",function(){e(T,T[t])}),T[t].addEventListener("mousedown",function(){e(T,T[t])}),T[t].addEventListener("touchend",function(e){i(e,T,T[t],!0),d()}),T[t].addEventListener("mouseup",function(e){i(e,T,T[t],!1),d()});setTimeout(function(){a()},o)},Array.isArray(e)){let t=Math.floor(i(0,e.length-1));h.src=e[t]}"string"==typeof e&&(h.src=e)}