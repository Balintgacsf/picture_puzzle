function get_img_puzzle(e){function t(){console.error("get_img_puzzle : Image could not be loaded")}function o(e,t){return Math.random()*(t-e)+e}function n(e){if(!1!==w)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(o){o.preventDefault(),!1!==w&&(p=this.offsetLeft,g=this.offsetTop,m=o.pageX,y=o.pageY,this.addEventListener("mousemove",r),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",r)}),document.querySelector(s).addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",r)}))}),e[t].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===w)return;p=this.offsetLeft,g=this.offsetTop;let n=o.touches;m=n[0].pageX,y=n[0].pageY,this.addEventListener("touchmove",i),document.querySelector(s).addEventListener("touchend",function(o){o.preventDefault(),e[t].removeEventListener("touchmove",i)})})}function r(e){this.style.left=p+e.pageX-m+"px",this.style.top=g+e.pageY-y+"px"}function i(e){var t=e.touches;this.style.left=p+t[0].pageX-m+"px",this.style.top=g+t[0].pageY-y+"px"}try{if("object"!=typeof e)throw"An object must be passed to the function! Now it is: "+typeof e}catch(e){return void console.error("get_img_puzzle : "+e)}let l=e.image,s=e.holder_div,f=e.after_win,u=e.difficulty||"regular",a=e.shuffle_delay||3e3,d=e.shuffle_integer||50;try{if("string"!=typeof l&&!Array.isArray(l))throw"images expecting to be a string or an array, "+typeof l+" given";if("string"!=typeof s)throw"div_holder expecting to be a string, "+typeof s+" given";if("function"!=typeof f)throw"win_function expecting to be a function, "+typeof f+" given";if("number"!=typeof a)throw"shuffle_delay expecting to be an number, "+typeof a+" given";if("number"!=typeof d)throw"shuffle_integer expecting to be an number, "+typeof d+" given";if("string"!=typeof u)throw"difficulty expecting to be a string, "+typeof u+" given";if("regular"!==u&&"hard"!==u)throw"difficulty can be regular or hard"}catch(e){return void console.error("get_img_puzzle : "+e)}let c,h,p,g,m,y,v=0,x=0,b=new Image,w=!1;if(document.querySelector(s).style.position="relative",document.querySelector(s).style.overflow="hidden",b.onerror=t,b.onload=function(){function e(o){if(!1===w)return;let n=document.querySelectorAll(s+" ."+o.target.classList);if("mousedown"===o.type||"touchstart"===o.type){o.target.addEventListener("mouseleave",e);for(let e=0;e<n.length;e++)n[e].style.transition="all 0s";X.push(o.target.offsetTop),X.push(o.target.offsetLeft),o.target.style.zIndex="999",0===v&&(c=new Date)}if("touchend"===o.type||"mouseup"===o.type){for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let e,r,i=document.querySelector(s).getBoundingClientRect(),f=window.innerWidth-i.right,u=window.innerHeight-i.bottom,a=[];"mouseup"===o.type&&(e=o.clientX,r=o.clientY,a.push(e-f,r)),"touchend"===o.type&&(u=i.top,f=i.left,e=o.changedTouches[0].clientX,r=o.changedTouches[0].clientY,a.push(e-f,r-u));let d=o.target.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=d){if(a[0]>n[e].offsetLeft&&a[0]<n[e].offsetLeft+n[e].offsetWidth&&a[1]>n[e].offsetTop&&a[1]<n[e].offsetTop+n[e].offsetHeight){t(o.target,n[e]),v++;break}e==n.length-1&&(o.target.style.top=X[0]+"px",o.target.style.left=X[1]+"px",X=[],x++)}o.target.style.zIndex="1",l()}return"mouseleave"===o.type?(o.target.removeEventListener("mouseleave",e),o.target.style.top=X[0]+"px",o.target.style.left=X[1]+"px",void(X=[])):void 0}function t(e,t){let n=e.getAttribute("data-sequence"),r=t.getAttribute("data-sequence");e.setAttribute("data-sequence",r),t.setAttribute("data-sequence",n),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=X[0]+"px",t.style.left=X[1]+"px",X=[],!0===w&&setTimeout(function(){o()},350)}function o(){for(let e=0;e<T.length;e++){let t=T[e].getAttribute("data-sequence");g+=t,e==T.length-1&&(g==p?(w=!1,r()):g="")}}function r(){h=new Date;let e=h-c,t=e/1e3%60,o={minutes:Math.round(e/1e3/60),seconds:Math.floor(t)},n={moves:v,cancelled_moves:x,time_ms:e,time_s:Math.floor(e/1e3),time_m:e/1e3/60,time_formatted:o,total_shuffle:d,played_difficulty:u};f(n,T)}function i(){let e=document.querySelectorAll(s+" .bg-elem");for(let o=0;o<d;o++){let r=Math.floor(Math.random()*e.length),i=Math.floor(Math.random()*e.length);if(X.push(e[r].offsetTop),X.push(e[r].offsetLeft),t(e[r],e[i]),o==d-1){w=!0;for(let e=0;e<T.length;e++)T[e].style.boxShadow="inset 1px 1px 3px #ccc";n(T)}}}function l(){!1!==w&&(w=!1,setTimeout(function(){w=!0},310))}let p="",g="",m=b.width,y=b.height,L=window.innerHeight,_=window.innerWidth,E=Math.min(_/m,L/y),q=0,A=0;if("regular"===u&&(q=7*Math.round(m*E/7),A=2*Math.round(y*E/2)),"hard"===u&&(q=7*Math.round(m*E/7),A=3*Math.round(y*E/3)),document.querySelectorAll(".bg-elem")){let t=document.querySelectorAll(".bg-elem");for(let o=0;o<t.length;o++)t[o].removeEventListener("touchstart",e),t[o].removeEventListener("mousedown",e),t[o].removeEventListener("touchend",e),t[o].removeEventListener("mouseup",e)}let z=document.querySelector(s);for(;z.firstChild;)z.removeChild(z.firstChild);clearTimeout(get_img_puzzle.wait);let M=0;"regular"===u&&(M=13),"hard"===u&&(M=20);for(let e=0;e<=M;e++)z.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";z.style.width=q+"px",z.style.height=A+"px",z.style.left="50%",z.style.marginLeft=-q/2+"px";let T=document.querySelectorAll(s+" .bg-elem");for(let e=0;e<T.length;e++){let t=T[e].getAttribute("data-sequence");p+=t}for(let e=0;e<T.length;e++)T[e].style.backgroundImage="url('"+b.src+"')",T[e].style.backgroundSize=q+"px "+A+"px",T[e].style.width=q/7+"px","regular"===u&&(T[e].style.height=A/2+"px"),"hard"===u&&(T[e].style.height=A/3+"px");let S=0;for(let e=0;e<T.length;e++){T[e].style.left=q/7*S+"px","regular"===u&&(e<=6&&(T[e].style.top="0px"),e>6&&(T[e].style.top=A/2+"px")),"hard"===u&&(e<=6&&(T[e].style.top="0px"),e>6&&e<14&&(T[e].style.top=A/3+"px"),e>=14&&(T[e].style.top=A/3+A/3+"px"));let t=T[e].offsetLeft,o=T[e].offsetTop;T[e].style.backgroundPosition=-t+"px "+-o+"px",S++,7==S&&(S=0)}let X=[];for(let t=0;t<T.length;t++)T[t].addEventListener("touchstart",e),T[t].addEventListener("mousedown",e),T[t].addEventListener("touchend",e),T[t].addEventListener("mouseup",e);get_img_puzzle.wait=setTimeout(i,a)},Array.isArray(l)){let e=Math.floor(o(0,l.length-1));b.src=l[e]}"string"==typeof l&&(b.src=l)}