function get_img_puzzle(e){function t(e,t){return Math.random()*(t-e)+e}function n(e){if(!1!==y)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(n){n.preventDefault(),!1!==y&&(d=this.offsetLeft,h=this.offsetTop,c=n.pageX,p=n.pageY,this.addEventListener("mousemove",o),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",o)}),document.querySelector(l).addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",o)}))}),e[t].addEventListener("touchstart",function(n){if(n.preventDefault(),!1===y)return;d=this.offsetLeft,h=this.offsetTop;let o=n.touches;c=o[0].pageX,p=o[0].pageY,this.addEventListener("touchmove",i),document.querySelector(l).addEventListener("touchend",function(n){n.preventDefault(),e[t].removeEventListener("touchmove",i)})})}function o(e){this.style.left=d+e.pageX-c+"px",this.style.top=h+e.pageY-p+"px"}function i(e){var t=e.touches;this.style.left=d+t[0].pageX-c+"px",this.style.top=h+t[0].pageY-p+"px"}let r=e.image,l=e.holder_div,s=e.after_win,f=e.difficulty||"regular",u=e.shuffle_delay||3e3,a=e.shuffle_integer||50;try{if("string"!=typeof r&&!Array.isArray(r))throw"images must be a string or an array";if("string"!=typeof l)throw"div_holder is not a string";if("function"!=typeof s)throw"win_function is not a function";if("number"!=typeof u)throw"shuffle_delay is not a number";if("number"!=typeof a)throw"shuffle_integer is not a number";if("string"!=typeof f)throw"difficulty is not a string";if("regular"!==f&&"hard"!==f)throw"difficulty can be regular or hard"}catch(e){console.log(e)}let d,h,c,p,g=new Image,y=!1;if(document.querySelector(l).style.position="relative",document.querySelector(l).style.overflow="hidden",g.onload=function(){function e(e,n){if(!1!==y){n.addEventListener("mouseleave",t);for(let t=0;t<e.length;t++)e[t].style.transition="all 0s";M.push(n.offsetTop),M.push(n.offsetLeft),n.style.zIndex="999"}}function t(e,n,i,r){if(!1===y)return;if("mouseleave"===e.type)return event.target.removeEventListener("mouseleave",t),event.target.style.top=M[0]+"px",event.target.style.left=M[1]+"px",void(M=[]);for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let s,f,u=window.innerWidth-document.querySelector(l).getBoundingClientRect().right,a=window.innerHeight-document.querySelector(l).getBoundingClientRect().bottom,d=[];!1===r&&(s=e.clientX,f=e.clientY,d.push(s-u,f+a)),!0===r&&(a=document.querySelector(l).getBoundingClientRect().top,u=document.querySelector(l).getBoundingClientRect().left,s=e.changedTouches[0].clientX,f=e.changedTouches[0].clientY,d.push(s-u,f-a));let h=i.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=h){if(d[0]>n[e].offsetLeft&&d[0]<n[e].offsetLeft+n[e].offsetWidth&&d[1]>n[e].offsetTop&&d[1]<n[e].offsetTop+n[e].offsetHeight){o(i,n[e]);break}e==n.length-1&&(i.style.top=M[0]+"px",i.style.left=M[1]+"px",M=[])}i.style.zIndex="1"}function o(e,t){let n=e.getAttribute("data-sequence"),o=t.getAttribute("data-sequence");e.setAttribute("data-sequence",o),t.setAttribute("data-sequence",n),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=M[0]+"px",t.style.left=M[1]+"px",M=[],!0===y&&setTimeout(function(){i()},350)}function i(){for(let e=0;e<A.length;e++){let t=A[e].getAttribute("data-sequence");p+=t,e==A.length-1&&(p==c?(y=!1,r()):p="")}}function r(){s()}function d(){let e=document.querySelectorAll(".bg-elem");for(let t=0;t<=a;t++){let i=Math.floor(Math.random()*e.length),r=Math.floor(Math.random()*e.length);if(M.push(e[i].offsetTop),M.push(e[i].offsetLeft),o(e[i],e[r]),t==a){y=!0;for(let e=0;e<A.length;e++)A[e].style.boxShadow="inset 1px 1px 3px #ccc";n(A)}}}function h(){!1!==y&&(y=!1,setTimeout(function(){y=!0},310))}let c="",p="",m=g.width,v=g.height,x=window.innerHeight,L=window.innerWidth,w=Math.min(L/m,x/v),b=0,q=0;"regular"===f&&(b=7*Math.round(m*w/7),q=2*Math.round(v*w/2)),"hard"===f&&(b=7*Math.round(m*w/7),q=3*Math.round(v*w/3));let E=document.querySelector(l);for(;E.firstChild;)E.removeChild(E.firstChild);let T=0;"regular"===f&&(T=13),"hard"===f&&(T=20);for(let e=0;e<=T;e++)E.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";E.style.width=b+"px",E.style.height=q+"px",E.style.left="50%",E.style.marginLeft=-b/2+"px";let A=document.querySelectorAll(".bg-elem");for(let e=0;e<A.length;e++){let t=A[e].getAttribute("data-sequence");c+=t}for(let e=0;e<A.length;e++)A[e].style.backgroundImage="url('"+g.src+"')",A[e].style.backgroundSize=b+"px "+q+"px",A[e].style.width=b/7+"px","regular"===f&&(A[e].style.height=q/2+"px"),"hard"===f&&(A[e].style.height=q/3+"px");let S=0;for(let e=0;e<A.length;e++){if("regular"===f){A[e].style.left=b/7*S+"px",e<=6&&(A[e].style.top="0px"),e>6&&(A[e].style.top=q/2+"px");let t=A[e].offsetLeft,n=A[e].offsetTop;A[e].style.backgroundPosition=-t+"px "+-n+"px"}if("hard"===f){A[e].style.left=b/7*S+"px",e<=6&&(A[e].style.top="0px"),e>6&&e<14&&(A[e].style.top=q/3+"px"),e>=14&&(A[e].style.top=q/3+q/3+"px");let t=A[e].offsetLeft,n=A[e].offsetTop;A[e].style.backgroundPosition=-t+"px "+-n+"px"}S++,7==S&&(S=0)}let M=[];for(let n=0;n<A.length;n++)A[n].addEventListener("touchstart",function(){e(A,A[n])}),A[n].addEventListener("mousedown",function(){e(A,A[n])}),A[n].addEventListener("touchend",function(e){t(e,A,A[n],!0),h()}),A[n].addEventListener("mouseup",function(e){t(e,A,A[n],!1),h()});setTimeout(function(){d()},u)},Array.isArray(r)){let e=Math.floor(t(0,r.length-1));g.src=r[e]}"string"==typeof r&&(g.src=r)}