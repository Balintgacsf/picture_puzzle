function get_img_puzzle(e){function t(e,t){return Math.random()*(t-e)+e}function o(e){if(!1!==L)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(o){o.preventDefault(),!1!==L&&(c=this.offsetLeft,p=this.offsetTop,g=o.pageX,y=o.pageY,this.addEventListener("mousemove",n),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",n)}),document.querySelector(i).addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",n)}))}),e[t].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===L)return;c=this.offsetLeft,p=this.offsetTop;let n=o.touches;g=n[0].pageX,y=n[0].pageY,this.addEventListener("touchmove",r),document.querySelector(i).addEventListener("touchend",function(o){o.preventDefault(),e[t].removeEventListener("touchmove",r)})})}function n(e){this.style.left=c+e.pageX-g+"px",this.style.top=p+e.pageY-y+"px"}function r(e){var t=e.touches;this.style.left=c+t[0].pageX-g+"px",this.style.top=p+t[0].pageY-y+"px"}let l=e.image,i=e.holder_div,s=e.after_win,f=e.difficulty||"regular",u=e.shuffle_delay||3e3,a=e.shuffle_integer||50;try{if("string"!=typeof l&&!Array.isArray(l))throw"images must be a string or an array";if("string"!=typeof i)throw"div_holder is not a string";if("function"!=typeof s)throw"win_function is not a function";if("number"!=typeof u)throw"shuffle_delay is not a number";if("number"!=typeof a)throw"shuffle_integer is not a number";if("string"!=typeof f)throw"difficulty is not a string";if("regular"!==f&&"hard"!==f)throw"difficulty can be regular or hard"}catch(e){console.log(e)}let h,d,c,p,g,y,m=0,v=0,x=new Image,L=!1;if(document.querySelector(i).style.position="relative",document.querySelector(i).style.overflow="hidden",x.onload=function(){function e(o){if(!1===L)return;let n=document.querySelectorAll("."+o.target.classList);if("mousedown"===o.type||"touchstart"===o.type){o.target.addEventListener("mouseleave",e);for(let e=0;e<n.length;e++)n[e].style.transition="all 0s";Y.push(o.target.offsetTop),Y.push(o.target.offsetLeft),o.target.style.zIndex="999",0===m&&(h=new Date)}if("touchend"===o.type||"mouseup"===o.type){for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let e,r,l=document.querySelector(i).getBoundingClientRect(),s=window.innerWidth-l.right,f=window.innerHeight-l.bottom,u=[];"mouseup"===o.type&&(e=o.clientX,r=o.clientY,u.push(e-s,r+f)),"touchend"===o.type&&(f=l.top,s=l.left,e=o.changedTouches[0].clientX,r=o.changedTouches[0].clientY,u.push(e-s,r-f));let a=o.target.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=a){if(u[0]>n[e].offsetLeft&&u[0]<n[e].offsetLeft+n[e].offsetWidth&&u[1]>n[e].offsetTop&&u[1]<n[e].offsetTop+n[e].offsetHeight){t(o.target,n[e]),m++;break}e==n.length-1&&(o.target.style.top=Y[0]+"px",o.target.style.left=Y[1]+"px",Y=[],v++)}o.target.style.zIndex="1",c()}return"mouseleave"===o.type?(o.target.removeEventListener("mouseleave",e),o.target.style.top=Y[0]+"px",o.target.style.left=Y[1]+"px",void(Y=[])):void 0}function t(e,t){let o=e.getAttribute("data-sequence"),r=t.getAttribute("data-sequence");e.setAttribute("data-sequence",r),t.setAttribute("data-sequence",o),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=Y[0]+"px",t.style.left=Y[1]+"px",Y=[],!0===L&&setTimeout(function(){n()},350)}function n(){for(let e=0;e<S.length;e++){let t=S[e].getAttribute("data-sequence");g+=t,e==S.length-1&&(g==p?(L=!1,r()):g="")}}function r(){d=new Date;let e=d-h,t={moves:m,cancelled_moves:v,time_s:Math.floor(e/1e3),time_m:Math.floor(e/1e3/60),total_shuffle:a,played_difficulty:f};s(t,S)}function l(){let e=document.querySelectorAll(".bg-elem");for(let n=0;n<=a;n++){let r=Math.floor(Math.random()*e.length),l=Math.floor(Math.random()*e.length);if(Y.push(e[r].offsetTop),Y.push(e[r].offsetLeft),t(e[r],e[l]),n==a){L=!0;for(let e=0;e<S.length;e++)S[e].style.boxShadow="inset 1px 1px 3px #ccc";o(S)}}}function c(){!1!==L&&(L=!1,setTimeout(function(){L=!0},310))}let p="",g="",y=x.width,w=x.height,b=window.innerHeight,E=window.innerWidth,q=Math.min(E/y,b/w),A=0,_=0;if("regular"===f&&(A=7*Math.round(y*q/7),_=2*Math.round(w*q/2)),"hard"===f&&(A=7*Math.round(y*q/7),_=3*Math.round(w*q/3)),document.querySelectorAll(".bg-elem")){let t=document.querySelectorAll(".bg-elem");for(let o=0;o<t.length;o++)t[o].removeEventListener("touchstart",e),t[o].removeEventListener("mousedown",e),t[o].removeEventListener("touchend",e),t[o].removeEventListener("mouseup",e)}let M=document.querySelector(i);for(;M.firstChild;)M.removeChild(M.firstChild);let T=0;"regular"===f&&(T=13),"hard"===f&&(T=20);for(let e=0;e<=T;e++)M.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";M.style.width=A+"px",M.style.height=_+"px",M.style.left="50%",M.style.marginLeft=-A/2+"px";let S=document.querySelectorAll(".bg-elem");for(let e=0;e<S.length;e++){let t=S[e].getAttribute("data-sequence");p+=t}for(let e=0;e<S.length;e++)S[e].style.backgroundImage="url('"+x.src+"')",S[e].style.backgroundSize=A+"px "+_+"px",S[e].style.width=A/7+"px","regular"===f&&(S[e].style.height=_/2+"px"),"hard"===f&&(S[e].style.height=_/3+"px");let X=0;for(let e=0;e<S.length;e++){S[e].style.left=A/7*X+"px","regular"===f&&(e<=6&&(S[e].style.top="0px"),e>6&&(S[e].style.top=_/2+"px")),"hard"===f&&(e<=6&&(S[e].style.top="0px"),e>6&&e<14&&(S[e].style.top=_/3+"px"),e>=14&&(S[e].style.top=_/3+_/3+"px"));let t=S[e].offsetLeft,o=S[e].offsetTop;S[e].style.backgroundPosition=-t+"px "+-o+"px",X++,7==X&&(X=0)}let Y=[];for(let t=0;t<S.length;t++)S[t].addEventListener("touchstart",e),S[t].addEventListener("mousedown",e),S[t].addEventListener("touchend",e),S[t].addEventListener("mouseup",e);setTimeout(function(){l()},u)},Array.isArray(l)){let e=Math.floor(t(0,l.length-1));x.src=l[e]}"string"==typeof l&&(x.src=l)}