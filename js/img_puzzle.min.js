function get_img_puzzle(e){function t(e,t){return Math.random()*(t-e)+e}function o(e){if(!1!==y)for(let t=0;t<e.length;t++)e[t].addEventListener("mousedown",function(o){o.preventDefault(),!1!==y&&(h=this.offsetLeft,d=this.offsetTop,p=o.pageX,c=o.pageY,this.addEventListener("mousemove",n),this.addEventListener("mouseleave",function(){this.removeEventListener("mousemove",n)}),document.querySelector(s).addEventListener("mouseup",function(){e[t].removeEventListener("mousemove",n)}))}),e[t].addEventListener("touchstart",function(o){if(o.preventDefault(),!1===y)return;h=this.offsetLeft,d=this.offsetTop;let n=o.touches;p=n[0].pageX,c=n[0].pageY,this.addEventListener("touchmove",r),document.querySelector(s).addEventListener("touchend",function(o){o.preventDefault(),e[t].removeEventListener("touchmove",r)})})}function n(e){this.style.left=h+e.pageX-p+"px",this.style.top=d+e.pageY-c+"px"}function r(e){var t=e.touches;this.style.left=h+t[0].pageX-p+"px",this.style.top=d+t[0].pageY-c+"px"}let i=e.image,s=e.holder_div,l=e.after_win,f=e.difficulty||"regular",u=e.shuffle_delay||3e3,a=e.shuffle_integer||50;try{if("string"!=typeof i&&!Array.isArray(i))throw"images must be a string or an array";if("string"!=typeof s)throw"div_holder is not a string";if("function"!=typeof l)throw"win_function is not a function";if("number"!=typeof u)throw"shuffle_delay is not a number";if("number"!=typeof a)throw"shuffle_integer is not a number";if("string"!=typeof f)throw"difficulty is not a string";if("regular"!==f&&"hard"!==f)throw"difficulty can be regular or hard"}catch(e){console.log(e)}let h,d,p,c,g=new Image,y=!1;if(document.querySelector(s).style.position="relative",document.querySelector(s).style.overflow="hidden",g.onload=function(){function e(o){if(!1===y)return;let n=document.querySelectorAll("."+o.target.classList);if("mousedown"===o.type||"touchstart"===o.type){o.target.addEventListener("mouseleave",e);for(let e=0;e<n.length;e++)n[e].style.transition="all 0s";M.push(o.target.offsetTop),M.push(o.target.offsetLeft),o.target.style.zIndex="999"}if("touchend"===o.type||"mouseup"===o.type){for(let e=0;e<n.length;e++)n[e].style.transition="all 0.3s";let e,r,i=document.querySelector(s).getBoundingClientRect(),l=window.innerWidth-i.right,f=window.innerHeight-i.bottom,u=[];"mouseup"===o.type&&(e=o.clientX,r=o.clientY,u.push(e-l,r+f)),"touchend"===o.type&&(f=i.top,l=i.left,e=o.changedTouches[0].clientX,r=o.changedTouches[0].clientY,u.push(e-l,r-f));let a=o.target.getAttribute("data-piece");for(let e=0;e<n.length;e++)if(e!=a){if(u[0]>n[e].offsetLeft&&u[0]<n[e].offsetLeft+n[e].offsetWidth&&u[1]>n[e].offsetTop&&u[1]<n[e].offsetTop+n[e].offsetHeight){t(o.target,n[e]);break}e==n.length-1&&(o.target.style.top=M[0]+"px",o.target.style.left=M[1]+"px",M=[])}o.target.style.zIndex="1",h()}return"mouseleave"===o.type?(o.target.removeEventListener("mouseleave",e),o.target.style.top=M[0]+"px",o.target.style.left=M[1]+"px",void(M=[])):void 0}function t(e,t){let o=e.getAttribute("data-sequence"),r=t.getAttribute("data-sequence");e.setAttribute("data-sequence",r),t.setAttribute("data-sequence",o),e.style.left=t.offsetLeft+"px",e.style.top=t.offsetTop+"px",t.style.top=M[0]+"px",t.style.left=M[1]+"px",M=[],!0===y&&setTimeout(function(){n()},350)}function n(){for(let e=0;e<A.length;e++){let t=A[e].getAttribute("data-sequence");p+=t,e==A.length-1&&(p==d?(y=!1,r()):p="")}}function r(){l(A)}function i(){let e=document.querySelectorAll(".bg-elem");for(let n=0;n<=a;n++){let r=Math.floor(Math.random()*e.length),i=Math.floor(Math.random()*e.length);if(M.push(e[r].offsetTop),M.push(e[r].offsetLeft),t(e[r],e[i]),n==a){y=!0;for(let e=0;e<A.length;e++)A[e].style.boxShadow="inset 1px 1px 3px #ccc";o(A)}}}function h(){!1!==y&&(y=!1,setTimeout(function(){y=!0},310))}let d="",p="",c=g.width,m=g.height,v=window.innerHeight,x=window.innerWidth,L=Math.min(x/c,v/m),w=0,b=0;"regular"===f&&(w=7*Math.round(c*L/7),b=2*Math.round(m*L/2)),"hard"===f&&(w=7*Math.round(c*L/7),b=3*Math.round(m*L/3));let q=document.querySelector(s);for(;q.firstChild;)q.removeChild(q.firstChild);let E=0;"regular"===f&&(E=13),"hard"===f&&(E=20);for(let e=0;e<=E;e++)q.innerHTML+="<div data-piece='"+e+"' data-sequence="+e+" class='bg-elem'></div>\n";q.style.width=w+"px",q.style.height=b+"px",q.style.left="50%",q.style.marginLeft=-w/2+"px";let A=document.querySelectorAll(".bg-elem");for(let e=0;e<A.length;e++){let t=A[e].getAttribute("data-sequence");d+=t}for(let e=0;e<A.length;e++)A[e].style.backgroundImage="url('"+g.src+"')",A[e].style.backgroundSize=w+"px "+b+"px",A[e].style.width=w/7+"px","regular"===f&&(A[e].style.height=b/2+"px"),"hard"===f&&(A[e].style.height=b/3+"px");let T=0;for(let e=0;e<A.length;e++){A[e].style.left=w/7*T+"px","regular"===f&&(e<=6&&(A[e].style.top="0px"),e>6&&(A[e].style.top=b/2+"px")),"hard"===f&&(e<=6&&(A[e].style.top="0px"),e>6&&e<14&&(A[e].style.top=b/3+"px"),e>=14&&(A[e].style.top=b/3+b/3+"px"));let t=A[e].offsetLeft,o=A[e].offsetTop;A[e].style.backgroundPosition=-t+"px "+-o+"px",T++,7==T&&(T=0)}let M=[];for(let t=0;t<A.length;t++)A[t].addEventListener("touchstart",e),A[t].addEventListener("mousedown",e),A[t].addEventListener("touchend",e),A[t].addEventListener("mouseup",e);setTimeout(function(){i()},u)},Array.isArray(i)){let e=Math.floor(t(0,i.length-1));g.src=i[e]}"string"==typeof i&&(g.src=i)}